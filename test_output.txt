============================= test session starts =============================
collecting ... collected 1 item

tests\s1f\test_s1f.py::TestS1F::test_machinereadable_separator FAILED    [100%]

================================== FAILURES ===================================
___________________ TestS1F.test_machinereadable_separator ____________________

self = <test_s1f.TestS1F object at 0x000001FF277D3050>

    def test_machinereadable_separator(self):
        """Test extracting files from a combined file with MachineReadable separator style."""
        input_file = OUTPUT_DIR / "machinereadable.txt"
    
        # Run the script programmatically
        run_s1f(
            [
                "--input-file",
                str(input_file),
                "--destination-directory",
                str(EXTRACTED_DIR),
                "--force",
            ]
        )
    
        # Get list of files in the extracted directory
        extracted_files = list(Path(EXTRACTED_DIR).glob("**/*.*"))
        assert len(extracted_files) > 0, "No files were extracted"
    
        # Verify that the extracted files match the originals
        # Get list of original files from the filelist.txt
        with open(
            OUTPUT_DIR / "machinereadable_filelist.txt", "r", encoding="utf-8"
        ) as f:
            original_file_paths = [line.strip() for line in f if line.strip()]
    
        # Get the source directory from the m1f test folder
        source_dir = Path(__file__).parent.parent / "m1f" / "source"
        original_files = [source_dir / path for path in original_file_paths]
    
        # Verify extracted files match original files
        matching, missing, different = verify_extracted_files(
            original_files, EXTRACTED_DIR
        )
    
        assert missing == 0, f"Found {missing} missing files"
>       assert different == 0, f"Found {different} files with different content"
E       AssertionError: Found 22 files with different content
E       assert 22 == 0

tests\s1f\test_s1f.py:300: AssertionError
---------------------------- Captured stdout setup ----------------------------

Running tests for s1f.py
Python version: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
Test directory: D:\projects\m1f\tests\s1f
Output directory: D:\projects\m1f\tests\s1f\output
Extracted directory: D:\projects\m1f\tests\s1f\extracted
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m: Reading input file: D:\projects\m1f\tests\s1f\output\machinereadable.txt
[32mINFO[0m: Parsing combined file content...
[32mINFO[0m: Writing 40 extracted file(s) to 'D:\projects\m1f\tests\s1f\extracted'...
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt'. Expected: 131 bytes, Actual: 66 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt.utf8'. Expected: 188 bytes, Actual: 183 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings.py'. Expected: 622 bytes, Actual: 602 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings_basic.py'. Expected: 1481 bytes, Actual: 1440 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\convert_encodings.py'. Expected: 1149 bytes, Actual: 1109 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt'. Expected: 257 bytes, Actual: 110 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt.utf8'. Expected: 360 bytes, Actual: 353 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt'. Expected: 209 bytes, Actual: 54 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt.utf8'. Expected: 358 bytes, Actual: 352 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt'. Expected: 233 bytes, Actual: 51 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt.utf8'. Expected: 408 bytes, Actual: 401 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt'. Expected: 152 bytes, Actual: 72 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt.utf8'. Expected: 217 bytes, Actual: 212 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_exotic_encodings.py'. Expected: 2917 bytes, Actual: 2821 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_s1f_extraction.py'. Expected: 6419 bytes, Actual: 6239 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_utf16_conversion.py'. Expected: 8039 bytes, Actual: 7819 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt'. Expected: 227 bytes, Actual: 59 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt.utf8'. Expected: 391 bytes, Actual: 385 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.json'. Expected: 123 bytes, Actual: 119 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.log'. Expected: 257 bytes, Actual: 255 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.py'. Expected: 260 bytes, Actual: 247 bytes.
[33mWARNING[0m: SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\test_encoding_conversion.py'. Expected: 2803 bytes, Actual: 2722 bytes.
[32mINFO[0m: File splitting process completed.
[32mINFO[0m: Files created: 40
[32mINFO[0m: Files overwritten (with --force or confirmation): 0
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\big5.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\big5.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\check_encodings.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\check_encodings_basic.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings_basic.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\convert_encodings.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\convert_encodings.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\euckr.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\euckr.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\iso8859-8.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\iso8859-8.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\koi8r.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\koi8r.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\shiftjis.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\shiftjis.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\test_exotic_encodings.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_exotic_encodings.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\test_s1f_extraction.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_s1f_extraction.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\test_utf16_conversion.py vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_utf16_conversion.py
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\windows1256.txt vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt
Content differs: D:\projects\m1f\tests\m1f\source\exotic_encodings\windows1256.txt.utf8 vs D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt.utf8
Content differs: D:\projects\m1f\tests\m1f\source\file_extensions_test\test.json vs D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.json
Content differs: D:\projects\m1f\tests\m1f\source\file_extensions_test\test.log vs D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.log
Content differs: D:\projects\m1f\tests\m1f\source\file_extensions_test\test.py vs D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.py
Content differs: D:\projects\m1f\tests\m1f\source\test_encoding_conversion.py vs D:\projects\m1f\tests\s1f\extracted\test_encoding_conversion.py
------------------------------ Captured log call ------------------------------
INFO     s1f:s1f.py:1197 Reading input file: D:\projects\m1f\tests\s1f\output\machinereadable.txt
INFO     s1f:s1f.py:1204 Parsing combined file content...
INFO     s1f:s1f.py:759 Writing 40 extracted file(s) to 'D:\projects\m1f\tests\s1f\extracted'...
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt'. Expected: 131 bytes, Actual: 66 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\big5.txt.utf8'. Expected: 188 bytes, Actual: 183 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings.py'. Expected: 622 bytes, Actual: 602 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\check_encodings_basic.py'. Expected: 1481 bytes, Actual: 1440 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\convert_encodings.py'. Expected: 1149 bytes, Actual: 1109 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt'. Expected: 257 bytes, Actual: 110 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\euckr.txt.utf8'. Expected: 360 bytes, Actual: 353 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt'. Expected: 209 bytes, Actual: 54 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\iso8859-8.txt.utf8'. Expected: 358 bytes, Actual: 352 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt'. Expected: 233 bytes, Actual: 51 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\koi8r.txt.utf8'. Expected: 408 bytes, Actual: 401 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt'. Expected: 152 bytes, Actual: 72 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\shiftjis.txt.utf8'. Expected: 217 bytes, Actual: 212 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_exotic_encodings.py'. Expected: 2917 bytes, Actual: 2821 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_s1f_extraction.py'. Expected: 6419 bytes, Actual: 6239 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\test_utf16_conversion.py'. Expected: 8039 bytes, Actual: 7819 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt'. Expected: 227 bytes, Actual: 59 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\exotic_encodings\windows1256.txt.utf8'. Expected: 391 bytes, Actual: 385 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.json'. Expected: 123 bytes, Actual: 119 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.log'. Expected: 257 bytes, Actual: 255 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\file_extensions_test\test.py'. Expected: 260 bytes, Actual: 247 bytes.
WARNING  s1f:s1f.py:924 SIZE MISMATCH for file 'D:\projects\m1f\tests\s1f\extracted\test_encoding_conversion.py'. Expected: 2803 bytes, Actual: 2722 bytes.
INFO     s1f:s1f.py:1223 File splitting process completed.
INFO     s1f:s1f.py:1224 Files created: 40
INFO     s1f:s1f.py:1225 Files overwritten (with --force or confirmation): 0
=========================== short test summary info ===========================
FAILED tests\s1f\test_s1f.py::TestS1F::test_machinereadable_separator - Asser...
============================== 1 failed in 0.19s ==============================
